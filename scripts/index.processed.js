import e,{useState as t,useEffect as n,useRef as a}from"https://cdn.skypack.dev/react@17.0.1";import o from"https://cdn.skypack.dev/react-dom@17.0.1";import{useSelector as l,useDispatch as s,Provider as i}from"https://cdn.skypack.dev/react-redux@7.2.4";import{createSlice as r,configureStore as c}from"https://cdn.skypack.dev/@reduxjs/toolkit@1.6.1";const g=2,m=3,h=4,p=5,d=8,u=9,f=0,y=9,k=7,w=14,x="https://assets.codepen.io/430361/",b=0,v=1,$=2,E={Main:0,Profile:1,Others:2,0:"Main",1:"Profile",2:"Others"},C=["alphabet","numeric","symbol","hiragana","katakana","kanji"],S="https://dev.to/takaneichinose",A="https://assets.codepen.io/430361/Resume+%282021_10_23%29.pdf",N=`${x}`,M={CharacterFront:"profile-character-front.png",CharacterFrontMove:"profile-character-front-move.gif",CharacterRear:"profile-character-rear.png",CharacterRearMove:"profile-character-rear-move.gif",CharacterLeft:"profile-character-left.png",CharacterLeftMove:"profile-character-left-move.gif",CharacterRight:"profile-character-right.png",CharacterRightMove:"profile-character-right-move.gif",Background:"profile-background.png",Carpet:"profile-carpet.png",Clock:"profile-clock.png",Door:"profile-door.png",Desk:"profile-desk.png",Drawer:"profile-drawer.png",Files:"profile-files.png",Laptop:"profile-laptop.png",Plant:"profile-plant.png",Shelf:"profile-shelf.png",Window:"profile-window.png",Alphabet:"profile-alphabet.png",SpeechDialog:"profile-speech-dialog.png",MenuButton:"profile-menu-button.png",Numeric:"profile-numeric.png",TextSelector:"profile-text-selector.png",MenuBackground:"profile-menu-background.png",MainMenu:"profile-main-menu.png",ProfileIcon:"profile-profile-icon.png",GithubIcon:"profile-github-icon.png",TwitterIcon:"profile-twitter-icon.png",CodepenIcon:"profile-codepen-icon.png",LaptopIcon:"profile-laptop-icon.png",FilesIcon:"profile-files-icon.png",MessageIcon:"profile-message-icon.png",AcknowledgementIcon:"profile-acknowledgement-icon.png",StatsImage:"profile-stats-image.png",StatsTitle:"profile-stats-title.png",StatsDescription:"profile-stats-description.png",Symbol:"profile-symbol.png",Acknowledgement:"profile-acknowledgement.png"},D=`${x}`,j={Background:"White+Christmas.mpga"},I=`${x}`,P={Text:"profile-internationalization.json",Alphabet:"profile-alphabet.json",Numeric:"profile-numeric.json",Symbol:"profile-symbol.json",Hiragana:"profile-hiragana.json",Katakana:"profile-katakana.json",Kanji:"profile-kanji.json",Skills1:"profile-skills-1.json",Skills2:"profile-skills-2.json"};class T{static log(e){console.log(e)}static toClassName(e){if("object"==typeof e){let t=[];for(let n in e)!0===e[n]&&(t=[...t,n]);e=t.join(" ")}return e}static getAssetSpec(e){let t={},n=null;switch(e){case b:n=M;break;case v:n=void 0;break;case $:n=P}if(null===n)return null;for(const e in n)t[e]=null;return t}static getAllAssets(){let e=[];for(const t in M)e=[...e,{key:t,url:M[t],type:b}];for(const t in j)e=[...e,{key:t,url:j[t],type:v}];for(const t in P)e=[...e,{key:t,url:P[t],type:$}];return e}static getAllAssetsCount(){return this.getAllAssets().length}static readBlobData(e){return new Promise(((t,n)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>{t(a.result)}}))}static loadBlob(e){return fetch(e).then((e=>{if(!e.ok)throw null;return e.blob()})).then((async e=>await this.readBlobData(e))).catch((t=>(console.error(`LoadAssetError: Failed to fetch data: ${e}`),null)))}static loadJSON(e){return fetch(e).then((e=>e.text())).then((e=>{try{return JSON.parse(e)}catch(t){return console.error(`LoadAssetError: Failed to parse JSON: ${e}`),null}})).catch((e=>(console.error(`LoadAssetError: Failed to fetch data: ${e}`),null)))}static loadAsset(e,t,n){return new Promise((async(a,o)=>{let l=null;n===b?l=await this.loadBlob(`${N}${e}`):n===v?l=await this.loadBlob(`${D}${e}`):n===$&&(l=await this.loadJSON(`${I}${e}`)),a({key:t,type:n,asset:l})}))}static setScreenPos(e,t,n){const a=e.clientWidth-1,o=e.clientHeight-1;return{x:Math.floor(t/(a/10)),y:Math.floor(n/(o/15))}}static allowByClickBoundary(e,t,n){const{x:a,y:o}=this.setScreenPos(e,t,n);return!(a<f||a>y||o<k||o>w)}static createMyProfileStyle(e){let t={};return null!==e.Background&&(t["--background-image"]=`url("${e.Background}")`),null!==e.Numeric&&(t["--numeric-image"]=`url("${e.Numeric}")`),null!==e.Alphabet&&(t["--alphabet-image"]=`url("${e.Alphabet}")`),null!==e.Symbol&&(t["--symbol-image"]=`url("${e.Symbol}")`),t}}const O=r({name:"assets",initialState:{text:{},lang:"en",numeric:[],alphabet:[],symbol:[],hiragana:[],katakana:[],kanji:[],skills1:[],skills2:[],image:T.getAssetSpec(b),audio:T.getAssetSpec(v)},reducers:{setImageAsset:(e,t)=>{const n=t.payload.key;e.image[n]=t.payload.value},setAudioAsset:(e,t)=>{const n=t.payload.key;e.audio[n]=t.payload.value},setJsonAsset:(e,t)=>{e[t.payload.key.toLowerCase()]=t.payload.value}}}),{setImageAsset:L,setAudioAsset:B,setJsonAsset:W}=O.actions;var z=O.reducer;const F=r({name:"character",initialState:{img:null,text:null,x:7,y:7,class:{character:!0,"character-animating":!1},style:{"--width":0,"--height":0,"--x":null,"--y":null,"--z":null,"--move-time":"512ms"},moveTo:null},reducers:{setCharacterImg:(e,t)=>{e.img=t.payload.img},setCharacterText:(e,t)=>{e.text=t.payload.text},setCharacterPosition:(e,t)=>{e.x=t.payload.x,e.y=t.payload.y},setCharacterStyle:(e,t)=>{const n=t.payload.style;for(const t in n)e.style[t]=n[t]},setCharacterAnimating:(e,t)=>{e.class["character-animating"]=t.payload.characterAnimating},startCharacterMovement:(e,t)=>{e.moveTo=t.payload.moveTo,e.class["character-animating"]=!0},stopCharacterMovement:e=>{e.moveTo=null,e.class["character-animating"]=!1}}}),{setCharacterImg:R,setCharacterText:J,setCharacterPosition:_,setCharacterStyle:H,setCharacterAnimating:G,startCharacterMovement:K,stopCharacterMovement:U}=F.actions;var X=F.reducer;const Y=r({name:"object",initialState:{objects:[]},reducers:{addObject:(e,t)=>{e.objects=[...e.objects,t.payload.object]},clearObjects:(e,t)=>{e.objects=[]}}}),{addObject:Z,clearObjects:q}=Y.actions;var Q=Y.reducer;const V=r({name:"system",initialState:{mainMenuShown:!1,speechDialogShown:!1,speechDialogMessage:null,speechDialogCallback:null,speechDialogConfirm:null,statsWindowShown:!1,acknowledgementShown:!1,screen:{width:0,height:0},loadedAssetsCount:0},reducers:{showMainMenu:e=>{e.mainMenuShown=!0},hideMainMenu:e=>{e.mainMenuShown=!1},showSpeechDialog:(e,t)=>{e.speechDialogShown=!0,e.speechDialogMessage=t.payload.message,e.speechDialogCallback=t.payload.callback,e.speechDialogConfirm=t.payload.confirm},hideSpeechDialog:e=>{e.speechDialogShown=!1,e.speechDialogMessage=null,e.speechDialogCallback=null,e.speechDialogConfirm=null},setScreenSize:(e,t)=>{e.screen.width=t.payload.width,e.screen.height=t.payload.height},setLoadedAssetsCount:(e,t)=>{e.loadedAssetsCount=t.payload.count},showStatsWindow:e=>{e.statsWindowShown=!0},hideStatsWindow:e=>{e.statsWindowShown=!1},showAcknowledgement:e=>{e.acknowledgementShown=!0},hideAcknowledgement:e=>{e.acknowledgementShown=!1}}}),{showMainMenu:ee,hideMainMenu:te,showSpeechDialog:ne,hideSpeechDialog:ae,setScreenSize:oe,setLoadedAssetsCount:le,showStatsWindow:se,hideStatsWindow:ie,showAcknowledgement:re,hideAcknowledgement:ce}=V.actions;var ge=c({reducer:{assets:z,character:X,object:Q,system:V.reducer}}),me=e.createElement("div",{className:"progress"});function he(){const a=T.getAllAssets(),o=T.getAllAssetsCount(),[i,r]=t(!0),[c,g]=t(null),m=l((e=>e.system)),h=s(),p=m.loadedAssetsCount;if(n((()=>{T.log("GAME INITIALIZED"),T.log(`Number of assets to load: ${o}`),T.log(`Image files: ${Object.keys(M).length}`),T.log(`Audio files: ${Object.keys(j).length}`),T.log(`JSON files: ${Object.keys(P).length}`),(()=>{for(let e=0;e<o;e++){const t=a[e].key,n=a[e].url,o=a[e].type;T.loadAsset(n,t,o).then((e=>{if(null===e)return e;g(e)}))}})()}),[]),n((()=>{(e=>{if(null===e)return;const{key:t,type:n,asset:a}=e;n===b?h(L({key:t,value:a})):n===v?h(B({key:t,value:a})):n===$&&h(W({key:t,value:a})),h(le({count:p+1}))})(c)}),[c]),!i)return null;const d=Math.floor(p/o*100),u="loading-screen-fade-out";let f="loading-screen";return p>=o&&(f+=` ${u}`),e.createElement("div",{className:f,style:{"--value":`${d}%`},onClick:e=>{e.stopPropagation()},onAnimationEnd:e=>{e.animationName===u&&r(!1)}},me)}function pe(n){const a=n.lang,[o,i]=t(!0),[r,c]=t(E.Main),g=s(),m=l((e=>e.assets));if(!o)return null;const h=m.text[a];let p=`instructions${E[r]}`;if(void 0===h||null===p)return null;const d=()=>{g(ne({message:h[p],callback:e=>{r+1>=Object.keys(E).length/2?i(!1):(c(r+1),d())}}))};return d(),e.createElement("div",{className:"instructions",onClick:e=>{e.stopPropagation()}})}function de(e,t,n,a){let o=null;e=e.toUpperCase();let l="",s="",i="";for(let r of C){const c=a[r];(o=c.indexOf(e))>=0&&(l=`var(--${r}-image)`,s=o*t*-1+"px 0px",i=`${c.length*t}px ${n}px`)}return{backgroundImage:l,backgroundPosition:s,backgroundSize:i}}function ue(t){const n=t.content,a=t.click,o=l((e=>e.system)),s=l((e=>e.assets)),i=.03125*o.screen.width,r=.05*o.screen.height;let c=[];for(const t of n.split(" ")){let n=[];for(const a of t){const{backgroundImage:t,backgroundPosition:o,backgroundSize:l}=de(a,i,r,s),c={"--width":`${i}px`,"--height":`${r}px`,"--background-image":t,"--background-position":o,"--background-size":l};n=[...n,e.createElement("div",{className:"text",style:c})]}c=[...c,e.createElement("div",{className:"word",style:{"--space":`${i}px`}},n)]}return null!=a?e.createElement("button",{className:"dialog-confirm-button",style:{"--width":`${i}px`,"--height":`${r}px`,"--selector-background-image":`url(${s.image.TextSelector})`},onClick:a},c):e.createElement("div",{className:"sentence"},c)}function fe(){const t=l((e=>e.system)),n=.03125*t.screen.width,a=.05*t.screen.height;return e.createElement("div",{className:"spacer",style:{"--width":`${n}px`,"--height":`${a}px`}})}var ye=e.createElement(fe,null),ke=e.createElement(fe,null);function we(t){const n=t.lang,a=t.confirm,o=l((e=>e.assets));return null==a?null:e.createElement("div",{className:"dialog-confirm"},e.createElement(ue,{content:o.text[n].no,click:()=>{null!==a.no&&void 0!==a.no&&a.no()}}),ye,ke,e.createElement(ue,{content:o.text[n].yes,click:()=>{null!==a.yes&&void 0!==a.yes&&a.yes()}}))}function xe(n){const a=n.lang,[o,i]=t(!1),r=l((e=>e.system)),c=l((e=>e.assets)),g=s(),m=r.speechDialogMessage,h=r.speechDialogCallback,p=r.speechDialogConfirm;if(!r.speechDialogShown||null===m)return null;const d="speech-dialog-fade-out";let u="speech-dialog";o&&(u+=` ${d}`);if(r.loadedAssetsCount<T.getAllAssetsCount())return null;const f={"--background-image":`url("${c.image.SpeechDialog}")`},y=.1*r.screen.width,k=.13333333333333333*r.screen.height;return e.createElement("article",{className:u,style:f,onClick:e=>{e.stopPropagation(),i(!0)},onAnimationEnd:e=>{e.animationName===d&&(g(ae()),i(!1),null!=h&&h())}},e.createElement("section",{className:"speech-dialog-box",style:{"--padding":`${k}px ${y}px`}},e.createElement(ue,{content:m}),e.createElement(we,{lang:a,confirm:p})))}function be(t){const n=t.img,a=t.text,o=t.x,s=t.y,i=t.callback,r=t.link,c=l((e=>e.system)),g=.11875*c.screen.width,m=.15833333333333333*c.screen.height,h=o*c.screen.width*.003125,p=s*c.screen.height*.004166666666666667;return e.createElement("a",{href:null!=r?r:null,target:null!=r?"_blank":null,className:"menu-button hoverable",style:{"--width":`${g}px`,"--height":`${m}px`,"--x":`${h}px`,"--y":`${p}px`},onClick:e=>{null!=i&&i(e)}},e.createElement("img",{src:n,alt:a}))}function ve(n){const a=n.lang,[o,i]=t(!1),r=l((e=>e.system)),c=l((e=>e.assets)),g=s();if(!r.mainMenuShown)return null;const m="main-menu-fade-out";let h="main-menu";o&&(h+=" main-menu-fade-out");const p=.05*r.screen.width,d=.06666666666666667*r.screen.height,u=.65*r.screen.width,f=.8666666666666667*r.screen.height,y=c.text[a];return e.createElement("nav",{className:h,style:{"--background-width":`${p}px`,"--background-height":`${d}px`},onClick:e=>{e.stopPropagation(),i(!0)},onAnimationEnd:e=>{e.animationName===m&&(g(te()),i(!1))}},e.createElement("div",{className:"menu-window",style:{"--background-image":`url(${c.image.MainMenu})`,"--width":`${u}px`,"--height":`${f}px`}},e.createElement(be,{img:c.image.ProfileIcon,text:y.menuProfile,x:40,y:64,callback:e=>{e.preventDefault(),g(se())}}),e.createElement(be,{img:c.image.FilesIcon,text:y.menuFiles,link:A,x:85,y:64}),e.createElement(be,{img:c.image.LaptopIcon,text:y.menuLaptop,link:S,x:130,y:64}),e.createElement(be,{img:c.image.MessageIcon,text:y.menuMessage,x:40,y:109,callback:e=>{e.preventDefault(),g(ne({message:y.messageConfirm,confirm:{yes:()=>{window.open("mailto:ichinose.takane@gmail.com","_blank")}}}))}}),e.createElement(be,{img:c.image.AcknowledgementIcon,text:y.menuAcknowledgement,x:85,y:109,callback:e=>{e.preventDefault(),g(re())}}),e.createElement(be,{img:c.image.GithubIcon,text:y.menuGithub,link:"https://github.com/takaneichinose",x:40,y:154}),e.createElement(be,{img:c.image.TwitterIcon,text:y.menuTwitter,link:"https://twitter.com/takane_ichi",x:85,y:154}),e.createElement(be,{img:c.image.CodepenIcon,text:y.menuCodepen,link:"https://codepen.io/takaneichinose",x:130,y:154})))}function $e(a){const o=a.lang,[i,r]=t(h),[c,f]=t(null),[y,k]=t([]),w=l((e=>e.assets)),x=l((e=>e.system)),b=l((e=>e.character)),v=l((e=>e.object)),$=s(),E=(e,t)=>y.indexOf(JSON.stringify({x:e,y:t}))>=0,C=(e,t,n,a,o,l,s)=>{for(const i of v.objects)if(i.hasCollision&&e+n>=i.x&&e+n<=i.x+i.width-1&&t+a>=i.y&&t+a<=i.y+i.height-1)switch(k([...y,JSON.stringify({x:e,y:t})]),s){case h:case p:return e>o||E(e+1,t)?C(e,t,-1,0,o,l,g):e<=o||E(e-1,t)?C(e,t,1,0,o,l,m):void 0;case g:case m:return t>l||E(e,t+1)?C(e,t,0,-1,o,l,p):t<=l||E(e,t-1)?C(e,t,0,1,o,l,h):void 0}return{x:e+n,y:t+a,characterDirection:s}},S=()=>{if(null===b.moveTo)return;const e=b.x,t=b.moveTo.x,n=b.y,a=b.moveTo.y;if(e===t&&n===a)return void $(U());let o=d;(e===t||E(e+1,n)||E(e-1,n))&&(o=u);try{const{x:l,y:s}=((e,t,n,a,o)=>{let l,s,i;return e===d&&t>n?i=C(t,a,-1,0,n,o,g):e===d&&t<=n?i=C(t,a,1,0,n,o,m):e===u&&a>o?i=C(t,a,0,-1,n,o,p):e===u&&a<=o&&(i=C(t,a,0,1,n,o,h)),l=i.x,s=i.y,r(i.characterDirection),{x:l,y:s}})(o,e,t,n,a);$(_({x:l,y:s}))}catch(e){}};return n((()=>{void 0!==w.text[o]&&$(J({text:w.text[o].character}))}),[w.text]),n((()=>{(()=>{let e="Character";switch(i){case h:e+="Front";break;case p:e+="Rear";break;case g:e+="Left";break;case m:e+="Right"}null!==b.moveTo&&(e+="Move"),null!==w.image[e]&&$(R({img:`${w.image[e]}`}))})()}),[w.image,i,b.moveTo]),n((()=>{var e,t,n;e=b.x,t=b.y,n=b.y+1,T.log(`Current position: { x: ${e}, y: ${t} }`),0!==e&&(e=.1*x.screen.width*e),0!==t&&(t=.06666666666666667*x.screen.height*t),$(H({style:{"--width":.1*x.screen.width+"px","--height":.06666666666666667*x.screen.height+"px","--x":`${e}px`,"--y":`${t}px`,"--z":n}}))}),[b.x,b.y,x.screen]),n((()=>{null!==b.moveTo&&(T.log(`Relocate position: { x: ${b.moveTo.x}, y: ${b.moveTo.y}}`),f(null),k([]),S())}),[b.moveTo]),e.createElement("figure",{className:T.toClassName(b.class),style:b.style,onClick:e=>{e.stopPropagation()},onTransitionEnd:e=>{"left"!==e.propertyName&&"top"!==e.propertyName||S()}},e.createElement("img",{src:b.img,alt:b.text}))}function Ee(a){const o=a.lang;t(!1),t(!1);const i=l((e=>e.assets)),r=l((e=>e.system)),c=l((e=>e.object)),g=s(),m=(e,t,n,a,o,l,s=null,c=null)=>{let m=!(void 0!==(c=null===c?{}:c).collision&&!c.collision);null===s&&(!1===m&&(s=0),s=l+1),T.log(`Placed "${e}" at: { x: ${o}, y: ${l}}`);const h=.1*r.screen.width*n,p=.06666666666666667*r.screen.height*a;g(Z({object:{name:e,img:`${i.image[e]}`,desc:t,x:o,y:l,width:h/(.1*r.screen.width),height:p/(.06666666666666667*r.screen.height),hasCollision:m,className:{object:!0,hoverable:void 0!==c.hoverable&&c.hoverable,"non-clickable":void 0!==c.nonClickable&&c.nonClickable},style:{"--width":`${h}px`,"--height":`${p}px`,"--x":o*r.screen.width*.1+"px","--y":l*r.screen.height*.06666666666666667+"px","--z":s},click:"function"==typeof c.click?c.click:null}}))};n((()=>{r.loadedAssetsCount<T.getAllAssetsCount()||(g(q()),(()=>{const e=i.text[o];m("Clock",e.decoration,.5,1,7.5,2.5),m("Door",e.decoration,1.5,3,7,4),m("Desk",e.decoration,2,1,3,11),m("Drawer",e.decoration,1,1,2,11),m("Plant",e.decoration,1,1,4,7),m("Plant",e.decoration,1,1,5,11),m("Shelf",e.decoration,2,1,0,7),m("Shelf",e.decoration,2,1,2,7),m("Shelf",e.decoration,2,1,7,12),m("Window",e.decoration,5,5,1,1),m("Laptop",e.portfolio,1,2,3.05,9,12,{collision:!1,hoverable:!0,click:()=>{g(ne({message:i.text[o].portfolio,confirm:{yes:()=>{T.log("Opening blog..."),T.log(`Portfolio: ${S}`),window.open(S,"_blank")}}}))}}),m("Files",e.resume,1,2,4,9.6,12,{collision:!1,hoverable:!0,click:()=>{g(ne({message:i.text[o].resume,confirm:{yes:()=>{T.log("Opening resume..."),T.log(`Portfolio: ${A}`),window.open(A,"_blank")}}}))}}),m("MenuButton",e.menu,.5,1,9,1,null,{collision:!1,hoverable:!0,click:()=>{g(ee())}}),m("Carpet",e.decoration,6,6,1.5,8.5,0,{collision:!1,nonClickable:!0})})())}),[i,r.screen]);let h=[];for(const t of c.objects)null!==t.img&&(h=[...h,e.createElement("figure",{className:T.toClassName(t.className),style:t.style,onClick:e=>{e.stopPropagation(),null!==t.click&&t.click()}},e.createElement("img",{src:t.img,alt:t.text}))]);return h}function Ce(){const t=l((e=>e.system)),n=l((e=>e.assets)),a=.2*t.screen.width,o=.3333333333333333*t.screen.height,s=.05*t.screen.width,i=.06666666666666667*t.screen.height;return e.createElement("div",{className:"stats-image",style:{"--background-image":`url(${n.image.StatsImage})`,"--width":`${a}px`,"--height":`${o}px`,"--x":`${s}px`,"--y":`${i}px`}})}function Se(t){const n=t.lang,a=l((e=>e.system)),o=l((e=>e.assets)),s=.65*a.screen.width,i=.3333333333333333*a.screen.height,r=.3*a.screen.width,c=.06666666666666667*a.screen.height,g=.05*a.screen.width,m=.06666666666666667*a.screen.height,h=o.text[n];return e.createElement("div",{className:"stats-title",style:{"--background-image":`url(${o.image.StatsTitle})`,"--width":`${s}px`,"--height":`${i}px`,"--padding":`${g}px ${m}px`,"--x":`${r}px`,"--y":`${c}px`}},e.createElement(ue,{content:h.statsName}),e.createElement(ue,{content:h.statsOccupation}),e.createElement(ue,{content:h.statsHobby}),e.createElement(ue,{content:h.statsHobby2}))}function Ae(t){const n=t.lang,a=l((e=>e.system)),o=l((e=>e.assets)),s=.9*a.screen.width,i=.4666666666666667*a.screen.height,r=.05*a.screen.width,c=.4666666666666667*a.screen.height,g=.05*a.screen.width,m=.06666666666666667*a.screen.height;o.text[n];let h=[],p=[];for(let t of o.skills1)h=[...h,e.createElement(ue,{content:t})];for(let t of o.skills2)p=[...p,e.createElement(ue,{content:t})];return e.createElement("div",{className:"stats-description",style:{"--background-image":`url(${o.image.StatsDescription})`,"--width":`${s}px`,"--height":`${i}px`,"--padding":`${g}px ${m}px`,"--x":`${r}px`,"--y":`${c}px`}},e.createElement("div",{className:"stats-description-details"},h),e.createElement("div",{className:"stats-description-details"},p))}var Ne=e.createElement(Ce,null);function Me(n){const a=n.lang,[o,i]=t(!1),r=l((e=>e.system));l((e=>e.assets));const c=s();if(!r.statsWindowShown)return null;const g="stats-window-fade-out";let m="stats-window";return o&&(m+=` ${g}`),e.createElement("div",{className:m,style:{},onClick:e=>{e.stopPropagation(),i(!0)},onAnimationEnd:e=>{e.animationName===g&&(c(ie()),i(!1))}},Ne,e.createElement(Se,{lang:a}),e.createElement(Ae,{lang:a}))}function De(n){const a=n.lang,[o,i]=t(!1),r=l((e=>e.system)),c=l((e=>e.assets)),g=s();if(!r.acknowledgementShown)return null;const m="acknowledgement-fade-out";let h="acknowledgement";o&&(h+=` ${m}`);const p=c.text[a],d=.9*r.screen.width,u=.8666666666666667*r.screen.height,f=.05*r.screen.width,y=.06666666666666667*r.screen.height;return e.createElement("div",{className:h,onClick:e=>{e.stopPropagation(),i(!0)},onAnimationEnd:e=>{e.animationName===m&&(g(ce()),i(!1))}},e.createElement("div",{className:"acknowledgement-dialog",style:{"--background-image":`url(${c.image.Acknowledgement})`,"--width":`${d}px`,"--height":`${u}px`,"--padding":`${f}px ${y}px`}},e.createElement(ue,{content:p.acknowledgementTitle}),e.createElement(ue,{content:p.acknowledgementDescription})))}var je=e.createElement(he,null);function Ie(o){const[i,r]=t("en"),c=l((e=>e.character));l((e=>e.object));const g=l((e=>e.assets)),m=s(),h=a(),p=()=>{const e=h.current.clientWidth,t=h.current.clientHeight;m(oe({width:e,height:t})),T.log(`Set screen size: { width: ${e}, height: ${t}}`)};n((()=>{void 0!==o.lang&&r(o.lang),T.log(`Current language settings: ${i}`)}),[i]),n((()=>(window.addEventListener("resize",p),p(),function(){window.removeEventListener("resize",p)})),[]);const d=T.createMyProfileStyle(g.image);return e.createElement("main",{className:"main-screen",style:d,onClick:e=>{if(null!==c.moveTo)return;const t=e.nativeEvent.offsetX,n=e.nativeEvent.offsetY;if(!T.allowByClickBoundary(h.current,t,n))return;const a=T.setScreenPos(h.current,t,n);m(K({moveTo:a}))},ref:h},e.createElement($e,{lang:i}),e.createElement(Ee,{lang:i}),e.createElement(ve,{lang:i}),e.createElement(pe,{lang:i}),e.createElement(Me,{lang:i}),e.createElement(De,{lang:i}),e.createElement(xe,{lang:i}),je)}var Pe=e.createElement(i,{store:ge},e.createElement(Ie,{lang:systemLanguage}));function Te(){return Pe}o.render(e.createElement(Te,null),document.getElementById("app"));
